<div class="transports-block">
  {% if transports is none %}
    <div>Вообще здесь должен быть блок доступных транспортов, но вы уже в городе отбытия</div>
  {% else %}
    <div class="itinerary-date-picker">
      <h2>Дата поездки</h2>
      <div class="date-block gap-4">
        <label>
          <input type="date" value="{{ session.start_date }}" id="start-date">
        </label>
        <div class="flex flex-col">
          <span class="font-medium">Обратно</span><span>{{ session.end_date | datetimeformat("d MMMM") }}</span>
        </div>
      </div>
    </div>
    {% if transports["there"]|length != 0 %}
      <div>
        <h2 class="text-2xl">Выбор транспорта</h2>
        <form method="post" class="flex flex-col gap-5">
          {% for direction, trips in transports.items() %}
            <div class="flex flex-col gap-4">
              {% if direction == "there" %}
                <h3 class="text-lg font-medium text-gray-800 tracking-tight">Туда:</h3>
              {% else %}
                <h3 class="text-lg font-medium text-gray-800 tracking-tight">Обратно:</h3>
              {% endif %}
              <div class="flex flex-col gap-3">
                {% for t in trips[:3] %}
                  <label for="transport-{{ t.uid }}">
                    <input class="peer hidden"
                           type="radio"
                           name="transport_{{ direction }}"
                           value="{{ t.uid }}"
                           data-type="transport"
                           data-cost="{{ t.start_cost_rub }}"
                           data-name="{{ t.title }}"
                           id="transport-{{ t.uid }}">
                    <div class="bg-neutral-100 peer-checked:ring-inset peer-checked:ring-2 peer-checked:ring-blue-500 px-5 py-6 rounded-lg cursor-pointer transition">
                      {{ t.transport_type }} {{ t.number }}
                      <div class="grid grid-cols-3 gap-6">
                        {% macro transport_time_block(datetime, station_title) %}
                          <div>
                            <div class="flex gap-2 items-start">
                              <span class="text-2xl font-medium">{{ datetime | datetimeformat("HH:mm") }}</span>
                              {{ datetime | datetimeformat("d MMMM") }}
                            </div>
                            <span class="font-medium">{{ station_title }}</span>
                          </div>
                        {% endmacro %}
                        {{ transport_time_block(t.departure, t.from_title) }}
                        {{ transport_time_block(t.arrival, t.to_title) }}
                        <div class="flex flex-col justify-between">
                          <div>{{ t.duration }}</div>
                          <div class="font-medium">
                            {% if t.start_cost_rub == None %}
                              Информации о цене нет
                            {% else %}
                              {{ t.start_cost_rub }}₽
                            {% endif %}
                            <div class="text-gray-700">{{ t.carrier.title }}</div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </label>
                {% endfor %}
              </div>
            </div>
          {% endfor %}
        </form>
      </div>
    {% else %}
      Рейсов из {{ session.city.name }} в {{ route.cities[0].city.name }} на {{ session.start_date }} не найдено. Попробуйте поменять даты поездки
    {% endif %}
  {% endif %}
</div>
